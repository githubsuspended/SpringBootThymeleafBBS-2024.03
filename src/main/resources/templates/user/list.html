<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<header th:replace="~{fragments/base :: head}"></header>
	<script>
		function uidClick(uid) {
			$.ajax({
				type: 'GET',
				url: '/abbs/user/detail/' + uid,
				success: function(jsonUser) {
					let user = JSON.parse(jsonUser);
					$('#imgSrc').attr({src: '/abbs/file/profile/' + user.profile});
					$('#uid').val(user.uid);
					$('#uid2').val(user.uid);
					$('#hashedPwd').val(user.pwd);
					$('#uname').val(user.uname);
					$('#email').val(user.email);
					$('#profile').val(user.profile);
					$('#github').val(user.github);
					$('#insta').val(user.insta);
					$('#location').val(user.location);
					$('#detailModal').modal('show');
				}
			});
		}
		function deleteUser() {
			let uid = $('#uid').val();
			const answer = confirm('정말로 삭제하시겠습니까?');
			if (answer)
				location.href = '/abbs/user/delete/' + uid;
		}
	</script>
</head>
<body>
	<div th:insert="~{fragments/base :: top}"></div>

	<div class="container" style="margin-top:80px">
		<div class="row">
			<div class="col-3">
				<aside th:replace="~{fragments/base :: aside}"></aside>
			</div>

			<div class="col-9">
				<main id="main">
					<h3><strong>사용자 목록</strong></h3>
					<hr>
					<table class="table">
						<tr>
							<th style="text-align: center;">프로필</th><th>UID</th><th>이름</th><th>이메일</th>
							<th>등록일</th><th>깃허브</th><th>인스타</th><th>지역</th>
						</tr>
						<tr th:each="user: ${userList}">
							<td style="text-align: center;"><img th:src="@{/file/profile/{x}(x=${user.profile})}" class="rounded-circle" height="28"></td>
							<td><a href="#" th:onclick="uidClick([[${user.uid}]])">[[${user.uid}]]</a></td>
							<td th:text="${user.uname}"></td>
							<td th:text="${user.email}"></td>
							<td th:text="${user.regDate}"></td>
							<td th:text="${user.github}"></td>
							<td th:text="${user.insta}"></td>
							<td th:text="${user.location}"></td>
						</tr>
					</table>
					<ul class="pagination justify-content-center mt-4">
						<li class="page-item"><a class="page-link" href="#"><i class="fa-solid fa-less-than"></i></a></li>
						<span th:each="page: ${pageList}">
							<span th:if="${session.currentUserPage == page}">
								<li class="page-item active">
									<a class="page-link" href="#">[[${page}]]</a>
								</li>
							</span>
							<span th:if="${session.currentUserPage != page}">
								<li class="page-item">
									<a class="page-link" th:href="@{/user/list/{x}(x=${page})}">[[${page}]]</a>
								</li>
							</span>
						</span>
						<li class="page-item"><a class="page-link" href="#"><i class="fa-solid fa-greater-than"></i></a></li>
					</ul> 
				</main>
			</div>
		</div>
	</div>

	<footer th:replace="~{fragments/base :: bottom}"></footer>
	<div th:insert="~{user/user_modal :: modal}"></div>
</body>
</html>